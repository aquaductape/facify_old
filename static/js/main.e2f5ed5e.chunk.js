(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,a){e.exports=a(84)},39:function(e,t,a){},42:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(25),o=a.n(i),c=(a(39),a(8)),l=a.n(c),s=a(26),u=a(27),m=a(28),f=a(33),d=a(29),g=a(10),v=a(32),h=(a(42),a(14)),p=a.n(h),b=a(30),w=a.n(b),E=function(e){var t=e.inputValue,a=e.onInputChange,n=e.onImageUpload,i=e.onButtonSubmit;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"multifile-upload-group"},r.a.createElement("input",{onChange:n,type:"file",name:"file",id:"file",className:"input-file--hidden"}),r.a.createElement("label",{className:"label-input-file",htmlFor:"file"},"Upload Image"),r.a.createElement("input",{autoFocus:!0,spellCheck:"false",value:t,onChange:a,className:"input-text",type:"text",placeholder:"Or type URL..."})),r.a.createElement("button",{onClick:i,className:"input-button"},"Detect"))))},y=(a(82),function(){return r.a.createElement("div",{className:"error-message"},"Oops! Something went wrong :( Perhapes the url is incorrect")}),x=function(e){var t=e.boundingBox,a={top:100*t.top_row+"%",right:100-100*t.right_col+"%",bottom:100-100*t.bottom_row+"%",left:100*t.left_col+"%"};return r.a.createElement("div",{className:"bounding-box",style:a})},U=function(e){var t=e.imageUrl,a=e.onMainImageLoad,n=e.boundingBox;return r.a.createElement("div",{className:"container"},r.a.createElement("img",{onLoad:function(e){return a(e,n)},className:"image-demo",src:t,alt:""}),n.map(function(e){var t=e.region_info,a=t.bounding_box,n="".concat(a.top_row).concat(a.left_col).concat(a.bottom_row).concat(a.right_col);return r.a.createElement(x,{key:n,boundingBox:t.bounding_box})}))},k=function(e){var t=e.boxId,a=e.onCanvas;return r.a.createElement("div",null,r.a.createElement("canvas",{ref:function(e){return e?a(e,t):null}}))},_=function(e){var t=e.boundingBox,a=e.onCanvas;return r.a.createElement("div",{className:"info-demo"},t.map(function(e){var t=e.region_info.bounding_box,n="".concat(t.top_row).concat(t.left_col).concat(t.bottom_row).concat(t.right_col);return r.a.createElement(k,{key:n,boxId:n,onCanvas:a})}))},C=function(e){var t=e.display,a=e.imageStatus,n=e.imageUrl,i=e.boundingBox,o=e.onMainImageLoad,c=e.onCanvas;return t="none"===t.display?t:{display:"grid"},null===a?null:400!==a?r.a.createElement("div",{style:t,className:"image-panel"},r.a.createElement(U,{imageUrl:n,boundingBox:i,onMainImageLoad:o}),r.a.createElement(_,{boundingBox:i,onCanvas:c})):r.a.createElement(y,null)},L=function(){return r.a.createElement("div",{id:"logo"},"\u15b4\u15e9\u1455I\u15b4Y")},I=function(e){var t=e.display,a=e.boundingBox,n=a&&a.length>1?"Faces":"Face";return a&&r.a.createElement("div",{style:t,className:"stats"},r.a.createElement("h1",null,"Found ","".concat(a.length," ").concat(n)," "))},S=function(e,t){return t.find(function(t){return t.id===e})},B=function(e){var t=e.filter(function(e){return e.clientHeight&&e.clientWidth});this.setState({canvasCollection:t})},N=function(e,t,a){var n=t.offsetWidth,r=t.offsetHeight,i=t.naturalWidth,o=t.naturalHeight,c=n-n*(a.left_col+(1-a.right_col)),l=r-r*(a.top_row+(1-a.bottom_row)),s=this.state.canvasCollection,u=S(e,s),m=70*c/l,f=(u=u.canvas).getContext("2d"),d=i*a.left_col,g=o*a.top_row,v=i/((i-(i*(1-a.right_col)+d))/m),h=o/((o-(o*(1-a.bottom_row)+g))/70);u.height=70,u.width=m,f.drawImage(t,d,g,i,o,0,0,v,h)},F=a(31),O=function(e,t,a,n){return new(a||(a=Promise))(function(r,i){function o(e){try{l(n.next(e))}catch(t){i(t)}}function c(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){e.done?r(e.value):new a(function(t){t(e.value)}).then(o,c)}l((n=n.apply(e,t||[])).next())})};function D(e,t){return O(this,void 0,void 0,l.a.mark(function a(){return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",j(e).then(function(a){return A(e,a||1,t||999999)}));case 1:case"end":return a.stop()}},a)}))}var j=function(e){return new Promise(function(t){var a=new FileReader;a.onload=function(){return t(function(){var e=new DataView(a.result);if(65496===e.getUint16(0,!1))for(var t=e.byteLength,n=2;n<t;){var r=e.getUint16(n,!1);if(n+=2,65505===r){if(n+=2,1165519206!==e.getUint32(n,!1))return;n+=6;var i=18761===e.getUint16(n,!1);n+=e.getUint32(n+4,i);var o=e.getUint16(n,i);n+=2;for(var c=0;c<o;c++)if(274===e.getUint16(n+12*c,i))return e.getUint16(n+12*c+8,i)}else{if(65280!==(65280&r))break;n+=e.getUint16(n,!1)}}}())},a.readAsArrayBuffer(e.slice(0,65536))})},A=function(e,t,a){return new Promise(function(n){var r=new FileReader;r.onload=function(){var e=r.result,i=new Image;i.onload=function(){var e=document.createElement("canvas"),r=e.getContext("2d"),o=i.width,c=i.height,l=t>=5&&t<=8?[c,o]:[o,c],s=Object(F.a)(l,2),u=s[0],m=s[1],f=u>a?a/u:1;switch(o*=f,c*=f,e.width=u*f,e.height=m*f,t){case 2:r.transform(-1,0,0,1,o,0);break;case 3:r.transform(-1,0,0,-1,o,c);break;case 4:r.transform(1,0,0,-1,0,c);break;case 5:r.transform(0,1,1,0,0,0);break;case 6:r.transform(0,1,-1,0,c,0);break;case 7:r.transform(0,-1,-1,0,c,o);break;case 8:r.transform(0,-1,1,0,0,c)}r.drawImage(i,0,0,o,c),n(e.toDataURL("image/jpeg"))},i.src=e},r.readAsDataURL(e)})};function R(e,t){var a=function(a){var n=new FileReader;n.onload=function(e){var n=e.target.result,r=new Image;r.onload=function(){var e=r.width,n=r.height,i=document.createElement("canvas"),o=i.getContext("2d");switch(4<a&&a<9?(i.width=n,i.height=e):(i.width=e,i.height=n),a){case 2:o.transform(-1,0,0,1,e,0);break;case 3:o.transform(-1,0,0,-1,e,n);break;case 4:o.transform(1,0,0,-1,0,n);break;case 5:o.transform(0,1,1,0,0,0);break;case 6:o.transform(0,1,-1,0,n,0);break;case 7:o.transform(0,-1,-1,0,n,e);break;case 8:o.transform(0,-1,1,0,0,e)}o.drawImage(r,0,0),t(i.toDataURL())},r.src=n},n.readAsDataURL(e)},n=new FileReader;n.onload=function(e){var t=new DataView(e.target.result);if(65496!==t.getUint16(0,!1))return a(-2);for(var n=t.byteLength,r=2;r<n;){var i=t.getUint16(r,!1);if(r+=2,65505===i){if(1165519206!==t.getUint32(r+=2,!1))return a(-1);var o=18761===t.getUint16(r+=6,!1);r+=t.getUint32(r+4,o);var c=t.getUint16(r,o);r+=2;for(var l=0;l<c;l++)if(274===t.getUint16(r+12*l,o))return a(t.getUint16(r+12*l+8,o))}else{if(65280!==(65280&i))break;r+=t.getUint16(r,!1)}}return a(-1)},n.readAsArrayBuffer(e)}a(83);var M=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"container-loader"},r.a.createElement("div",{className:"fulfilling-square-spinner"},r.a.createElement("div",{className:"spinner-inner"}))),r.a.createElement("h6",null,"Rotating Base64 Image URL"))},q=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"container-loader"},r.a.createElement("div",{className:"swapping-squares-spinner"},r.a.createElement("div",{className:"square"}),r.a.createElement("div",{className:"square"}),r.a.createElement("div",{className:"square"}),r.a.createElement("div",{className:"square"}))),r.a.createElement("h6",null,"Locating Faces"))},P=function(e){var t;switch(e.loading){case"yes:client":t=r.a.createElement(M,null);break;case"yes:clarifai":t=r.a.createElement(q,null);break;default:t=null}return t},V=new p.a.App({apiKey:"f816634000e34c3b9c5271e13f690d5f"}),W=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(f.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={input:"",imageUrl:"",imageStatusOk:null,imageSize:null,boundingBox:null,canvasCollection:[],isLoading:!1},a.clarifaiDetectFace=function(e){var t,n=e;"object"===typeof e&&(n=e.base64,t=e.base64.replace(/data:.*;base64,/,""),e.base64=t),V.models.predict(p.a.FACE_DETECT_MODEL,e).then(function(e){var t=e.outputs[0].data.regions||[];a.setState({isLoading:!1}),a.setState({boundingBox:t}),a.setState({imageStatusOk:!0}),a.setState({imageUrl:n})},function(e){a.setState({isLoading:!1}),a.setState({imageStatusOk:e.status}),a.setState({boundingBox:null})})},a.onInputChange=function(e){a.setState({input:e.target.value})},a.onCanvas=function(e,t){var n=a.state.canvasCollection.slice(),r={id:t,canvas:e};S(t,n)||(n.push(r),a.setState({canvasCollection:n}))},a.onMainImageLoad=function(e,t){var n=e.target;t.forEach(function(e){var t=e.region_info.bounding_box,r="".concat(t.top_row).concat(t.left_col).concat(t.bottom_row).concat(t.right_col);N.call(Object(g.a)(a),r,n,t)}),B.call(Object(g.a)(a),a.state.canvasCollection.slice())},a.onImageUpload=function(e){var t=e.target.files[0];if(!t)return null;a.setState({isLoading:"yes:client"}),w.a.parseMetaData(t,function(){var e=Object(s.a)(l.a.mark(function e(n){var r,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.exif&&n.exif.getAll())&&!(r.GPSVersionID&&r.FocalLength>=4)){e.next=9;break}return e.next=4,D(t);case 4:i=e.sent,a.setState({isLoading:"yes:clarifai"}),a.clarifaiDetectFace({base64:i}),e.next=12;break;case 9:a.setState({isLoading:"yes:clarifai"}),R(t,function(e){a.clarifaiDetectFace({base64:e})});case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},a.onButtonSubmit=function(e){var t=a.state.input.trim();if(t===a.state.imageUrl)return null;a.clarifaiDetectFace(t)},a}return Object(v.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e,t;return"yes:client"===this.state.isLoading||"yes:clarifai"===this.state.isLoading?(e={height:"500px"},t={display:"none"}):(e=null,t={display:"block"}),r.a.createElement("div",{className:"App"},r.a.createElement(L,null),r.a.createElement("main",{style:e},r.a.createElement(E,{inputValue:this.state.input,onImageUpload:this.onImageUpload,onButtonSubmit:this.onButtonSubmit,onInputChange:this.onInputChange}),r.a.createElement(P,{loading:this.state.isLoading}),r.a.createElement(I,{display:t,boundingBox:this.state.boundingBox}),r.a.createElement(C,{display:t,imageStatus:this.state.imageStatusOk,imageUrl:this.state.imageUrl,onMainImageLoad:this.onMainImageLoad,boundingBox:this.state.boundingBox,onCanvas:this.onCanvas})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[34,1,2]]]);
//# sourceMappingURL=main.e2f5ed5e.chunk.js.map