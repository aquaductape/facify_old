(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,n){e.exports=n(83)},39:function(e,t,n){},42:function(e,t,n){},82:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(26),i=n.n(o),c=(n(39),n(6)),u=n.n(c),l=n(14),s=n(27),f=n(28),m=n(33),g=n(29),d=n(10),v=n(32),h=(n(42),n(15)),b=n.n(h),p=n(30),w=n.n(p),x=function(e){var t=e.inputValue,n=e.onInputChange,a=e.onImageUpload,o=e.onButtonSubmit;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"input-group"},r.a.createElement("div",{className:"multifile-upload-group"},r.a.createElement("input",{onChange:a,type:"file",name:"file",id:"file",className:"input-file--hidden"}),r.a.createElement("label",{className:"label-input-file",htmlFor:"file"},"Upload Image"),r.a.createElement("input",{autoFocus:!0,spellCheck:"false",value:t,onChange:n,className:"input-text",type:"text",placeholder:"Or type URL..."})),r.a.createElement("button",{onClick:o,className:"input-button"},"Detect"))))},E=(n(82),function(){return r.a.createElement("div",{className:"error-message"},"Oops! Something went wrong :( Perhapes the url is incorrect")}),U=function(e){var t=e.boundingBox,n={top:100*t.top_row+"%",right:100-100*t.right_col+"%",bottom:100-100*t.bottom_row+"%",left:100*t.left_col+"%"};return r.a.createElement("div",{className:"bounding-box",style:n})},k=function(e){var t=e.imageUrl,n=e.onMainImageLoad,a=e.boundingBox;return r.a.createElement("div",{className:"container"},r.a.createElement("img",{onLoad:function(e){return n(e,a)},className:"image-demo",src:t,alt:""}),a.map(function(e){var t=e.region_info,n=t.bounding_box,a="".concat(n.top_row).concat(n.left_col).concat(n.bottom_row).concat(n.right_col);return r.a.createElement(U,{key:a,boundingBox:t.bounding_box})}))},_=function(e){var t=e.boxId,n=e.onCanvas;return r.a.createElement("div",null,r.a.createElement("canvas",{ref:function(e){return e?n(e,t):null}}))},C=function(e){var t=e.boundingBox,n=e.onCanvas;return r.a.createElement("div",{className:"info-demo"},t.map(function(e){var t=e.region_info.bounding_box,a="".concat(t.top_row).concat(t.left_col).concat(t.bottom_row).concat(t.right_col);return r.a.createElement(_,{key:a,boxId:a,onCanvas:n})}))},I=function(e){var t=e.imageStatus,n=e.imageUrl,a=e.boundingBox,o=e.onMainImageLoad,i=e.onCanvas;return null===t?null:400!==t?r.a.createElement("div",{className:"image-panel",style:{maxWidth:"800px"}},r.a.createElement(k,{imageUrl:n,boundingBox:a,onMainImageLoad:o}),r.a.createElement(C,{boundingBox:a,onCanvas:i})):r.a.createElement(E,null)},y=function(){return r.a.createElement("div",{id:"logo"},"\u15b4\u15e9\u1455I\u15b4Y")},B=function(e){var t=e.boundingBox,n=t&&t.length>1?"Faces":"Face";return t&&r.a.createElement("div",{className:"stats"},r.a.createElement("h1",null,"Found ","".concat(t.length," ").concat(n)," "))},S=function(e,t){return t.find(function(t){return t.id===e})},O=function(e){var t=e.filter(function(e){return e.clientHeight&&e.clientWidth});this.setState({canvasCollection:t})},D=function(e,t,n){var a=t.offsetWidth,r=t.offsetHeight,o=t.naturalWidth,i=t.naturalHeight,c=a-a*(n.left_col+(1-n.right_col)),u=r-r*(n.top_row+(1-n.bottom_row)),l=this.state.canvasCollection,s=S(e,l),f=70*c/u,m=(s=s.canvas).getContext("2d"),g=o*n.left_col,d=i*n.top_row,v=o/((o-(o*(1-n.right_col)+g))/f),h=i/((i-(i*(1-n.bottom_row)+d))/70);s.height=70,s.width=f,m.drawImage(t,g,d,o,i,0,0,v,h)},L=n(31),F=function(e,t,n,a){return new(n||(n=Promise))(function(r,o){function i(e){try{u(a.next(e))}catch(t){o(t)}}function c(e){try{u(a.throw(e))}catch(t){o(t)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(i,c)}u((a=a.apply(e,t||[])).next())})};function N(e,t){return F(this,void 0,void 0,u.a.mark(function n(){return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",j(e).then(function(n){return A(e,n||1,t||999999)}));case 1:case"end":return n.stop()}},n)}))}var j=function(e){return new Promise(function(t){var n=new FileReader;n.onload=function(){return t(function(){var e=new DataView(n.result);if(65496===e.getUint16(0,!1))for(var t=e.byteLength,a=2;a<t;){var r=e.getUint16(a,!1);if(a+=2,65505===r){if(a+=2,1165519206!==e.getUint32(a,!1))return;a+=6;var o=18761===e.getUint16(a,!1);a+=e.getUint32(a+4,o);var i=e.getUint16(a,o);a+=2;for(var c=0;c<i;c++)if(274===e.getUint16(a+12*c,o))return e.getUint16(a+12*c+8,o)}else{if(65280!==(65280&r))break;a+=e.getUint16(a,!1)}}}())},n.readAsArrayBuffer(e.slice(0,65536))})},A=function(e,t,n){return new Promise(function(a){var r=new FileReader;r.onload=function(){var e=r.result,o=new Image;o.onload=function(){var e=document.createElement("canvas"),r=e.getContext("2d"),i=o.width,c=o.height,u=t>=5&&t<=8?[c,i]:[i,c],l=Object(L.a)(u,2),s=l[0],f=l[1],m=s>n?n/s:1;switch(i*=m,c*=m,e.width=s*m,e.height=f*m,t){case 2:r.transform(-1,0,0,1,i,0);break;case 3:r.transform(-1,0,0,-1,i,c);break;case 4:r.transform(1,0,0,-1,0,c);break;case 5:r.transform(0,1,1,0,0,0);break;case 6:r.transform(0,1,-1,0,c,0);break;case 7:r.transform(0,-1,-1,0,c,i);break;case 8:r.transform(0,-1,1,0,0,c)}r.drawImage(o,0,0,i,c),a(e.toDataURL("image/jpeg"))},o.src=e},r.readAsDataURL(e)})};function R(e,t){var n=function(n){var a=new FileReader;a.onload=function(e){var a=e.target.result,r=new Image;r.onload=function(){var e=r.width,a=r.height,o=document.createElement("canvas"),i=o.getContext("2d");switch(4<n&&n<9?(o.width=a,o.height=e):(o.width=e,o.height=a),n){case 2:i.transform(-1,0,0,1,e,0);break;case 3:i.transform(-1,0,0,-1,e,a);break;case 4:i.transform(1,0,0,-1,0,a);break;case 5:i.transform(0,1,1,0,0,0);break;case 6:i.transform(0,1,-1,0,a,0);break;case 7:i.transform(0,-1,-1,0,a,e);break;case 8:i.transform(0,-1,1,0,0,e)}i.drawImage(r,0,0),t(o.toDataURL())},r.src=a},a.readAsDataURL(e)},a=new FileReader;a.onload=function(e){var t=new DataView(e.target.result);if(65496!==t.getUint16(0,!1))return n(-2);for(var a=t.byteLength,r=2;r<a;){var o=t.getUint16(r,!1);if(r+=2,65505===o){if(1165519206!==t.getUint32(r+=2,!1))return n(-1);var i=18761===t.getUint16(r+=6,!1);r+=t.getUint32(r+4,i);var c=t.getUint16(r,i);r+=2;for(var u=0;u<c;u++)if(274===t.getUint16(r+12*u,i))return n(t.getUint16(r+12*u+8,i))}else{if(65280!==(65280&o))break;r+=t.getUint16(r,!1)}}return n(-1)},a.readAsArrayBuffer(e)}var M=new b.a.App({apiKey:"f816634000e34c3b9c5271e13f690d5f"}),W=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(m.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).state={input:"",imageUrl:"",imageStatusOk:null,imageSize:null,boundingBox:null,canvasCollection:[],fileData:null},n.clarifaiDetectFace=function(e){var t,a=e;"object"===typeof e&&(a=e.base64,t=e.base64.replace(/data:.*;base64,/,""),e.base64=t),M.models.predict(b.a.FACE_DETECT_MODEL,e).then(function(e){var t=e.outputs[0].data.regions||[];n.setState({boundingBox:t}),n.setState({imageStatusOk:!0}),n.setState({imageUrl:a})},function(e){n.setState({imageStatusOk:e.status}),n.setState({boundingBox:null})})},n.onInputChange=function(e){n.setState({input:e.target.value})},n.onCanvas=function(e,t){var a=n.state.canvasCollection.slice(),r={id:t,canvas:e};S(t,a)||(a.push(r),n.setState({canvasCollection:a}))},n.onMainImageLoad=function(e,t){var a=e.target;t.forEach(function(e){var t=e.region_info.bounding_box,r="".concat(t.top_row).concat(t.left_col).concat(t.bottom_row).concat(t.right_col);D.call(Object(d.a)(n),r,a,t)}),O.call(Object(d.a)(n),n.state.canvasCollection.slice())},n.onImageUpload=function(){var e=Object(l.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.files[0]){e.next=3;break}return e.abrupt("return",null);case 3:w.a.parseMetaData(a,function(){var e=Object(l.a)(u.a.mark(function e(t){var r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t.exif&&t.exif.getAll())&&!(r.GPSVersionID&&r.FocalLength>=4)){e.next=10;break}return e.next=5,N(a);case 5:o=e.sent,n.clarifaiDetectFace({base64:o}),e.next=11;break;case 10:R(a,function(e){n.clarifaiDetectFace({base64:e})});case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onButtonSubmit=function(e){var t=n.state.input.trim();if(t===n.state.imageUrl)return null;n.clarifaiDetectFace(t)},n}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(y,null),r.a.createElement("main",null,r.a.createElement(x,{inputValue:this.state.input,onImageUpload:this.onImageUpload,onButtonSubmit:this.onButtonSubmit,onInputChange:this.onInputChange}),r.a.createElement(B,{boundingBox:this.state.boundingBox}),r.a.createElement(I,{imageStatus:this.state.imageStatusOk,imageUrl:this.state.imageUrl,onMainImageLoad:this.onMainImageLoad,boundingBox:this.state.boundingBox,onCanvas:this.onCanvas})))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[34,1,2]]]);
//# sourceMappingURL=main.b5630c8a.chunk.js.map